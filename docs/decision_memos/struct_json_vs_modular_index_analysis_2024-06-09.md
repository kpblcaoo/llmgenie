# Аналитическая записка: struct.json vs модульный индекс

**Дата:** 2025-06-07
**Автор:** AI (llmstruct)
**Режим:** [meta][discuss][docs]

## 1. Назначение и структура

### struct.json
- Описывает структуру проекта целиком (модули, файлы, связи, типы, точки входа)
- Используется для анализа, генерации документации, навигации, LLM-контекста
- Может быть сгенерирован автоматически (llmstruct parse)

### Модульный индекс (.llmstruct_index/)
- Хранит отдельные JSON-структуры по каждому модулю/файлу
- Позволяет быстро анализировать изменения, делать инкрементальный аудит
- Ускоряет работу с большими проектами, где struct.json становится слишком большим

## 2. Best practices для аудитора и кодера

### Project Auditor
- Использует struct.json для общего обзора и сверки структуры
- Использует модульный индекс для быстрой проверки отдельных файлов/модулей, выявления расхождений
- Сравнивает struct.json, модульный индекс и project_state.json для поиска несоответствий
- При обнаружении расхождений инициирует актуализацию project_state.json и/или struct.json

### КОДЕР
- Использует модульный индекс для локального анализа и быстрой навигации по коду
- Может обновлять struct.json после крупных изменений (через llmstruct parse)
- Сверяет изменения с модульным индексом для контроля инкрементальных изменений

## 3. Применимость для других ролей

- **reviewer:** Быстро находит изменённые или подозрительные модули через модульный индекс, сверяет с общей структурой
- **librarian:** Использует struct.json для генерации документации, навигации, построения карт проекта
- **devops:** Может использовать struct.json для автоматизации деплоя, анализа зависимостей
- **admin:** Контролирует целостность структуры, сверяет с политиками безопасности
- **user:** Может использовать struct.json для понимания архитектуры, но редко работает с модульным индексом напрямую

## 4. Выводы и рекомендации
- Для небольших проектов достаточно struct.json
- Для средних и крупных — рекомендуется использовать оба: struct.json для общего обзора, модульный индекс для ускоренного анализа и аудита
- Аудитор и кодер должны уметь работать с обоими форматами, знать их плюсы и ограничения
- Для автоматизации аудита и CI/CD — использовать модульный индекс для инкрементальных проверок
- Все расхождения между struct.json, модульным индексом и project_state.json должны фиксироваться и устраняться

---
**Источники:**
- project_state.json
- struct.json
- .llmstruct_index/
- atomic rule Project Auditor
- docs/decision_memos/decision_memo_project_auditor_2024-06-09.md 