# 🔧 Техническая База Проекта llmgenie

**Версия:** 1.0  
**Дата:** 5 июня 2025  
**Для:** DevOps onboarding - техническая референс

---

## 🏗️ Архитектура Системы

### High-Level Architecture
```
┌─────────────────────────────────────────────────────────┐
│                 llmgenie Platform                       │
├─────────────────────────────────────────────────────────┤
│  Multi-Agent Orchestration Layer                        │
│  ├── BOSS Agent (Coordinator)                          │
│  ├── DevOps Agent (Infrastructure)                     │
│  ├── Security Agent (Compliance)                       │
│  ├── Performance Agent (Optimization)                  │
│  └── Documentation Agent (Knowledge)                   │
├─────────────────────────────────────────────────────────┤
│  Smart Wrapper Layer                                   │
│  ├── Context Analysis                                  │
│  ├── Permission Check                                  │
│  ├── Environment Setup                                 │
│  └── Execute with Fallback                            │
├─────────────────────────────────────────────────────────┤
│  Integration Layer                                      │
│  ├── Cursor IDE Integration                            │
│  ├── VSCode Extension                                  │
│  ├── CLI Interface                                     │
│  └── REST API                                          │
├─────────────────────────────────────────────────────────┤
│  Infrastructure Layer                                   │
│  ├── Kubernetes Orchestration                         │
│  ├── Docker Containers                                │
│  ├── Monitoring & Logging                             │
│  └── Security & Compliance                            │
└─────────────────────────────────────────────────────────┘
```

---

## 🛠️ Technology Stack

### Core Framework
- **Primary Language:** Python 3.11+
- **Agent Framework:** CrewAI (primary), AutoGPT (planned), MetaGPT (planned)
- **LLM Integration:** OpenAI API, Anthropic Claude, Local models support
- **Async Processing:** asyncio, celery для background tasks

### Infrastructure & DevOps
- **Containerization:** Docker, Docker Compose
- **Orchestration:** Kubernetes (K8s)
- **CI/CD:** GitHub Actions, ArgoCD (planned)
- **Cloud Providers:** AWS (primary), GCP/Azure (multi-cloud ready)

### Monitoring & Observability  
- **Metrics:** Prometheus + Grafana
- **Logging:** ELK Stack (Elasticsearch, Logstash, Kibana) or Loki
- **Tracing:** Jaeger для distributed tracing
- **Alerting:** AlertManager + PagerDuty/Slack integration

### Database & Storage
- **Primary DB:** PostgreSQL для metadata
- **Cache:** Redis для session management
- **Vector DB:** ChromaDB для knowledge base
- **Object Storage:** S3-compatible для artifacts

### API & Communication
- **Web Framework:** FastAPI для REST API
- **WebSocket:** For real-time agent communication
- **Message Queue:** RabbitMQ или Apache Kafka
- **API Gateway:** Traefik или NGINX Ingress

---

## 🔌 Multi-Agent Framework Integration

### CrewAI Integration (Phase 1)
```python
# Simplified architecture example
from crewai import Agent, Task, Crew

class LLMGenieOrchestrator:
    def __init__(self):
        self.boss_agent = Agent(
            role="Coordinator",
            goal="Orchestrate multi-agent tasks",
            backstory="Enterprise task management expert"
        )
        
        self.devops_agent = Agent(
            role="DevOps Engineer", 
            goal="Infrastructure automation",
            backstory="Kubernetes and CI/CD expert"
        )
        
    def create_crew(self, task_description):
        return Crew(
            agents=[self.boss_agent, self.devops_agent],
            tasks=[Task(description=task_description)],
            verbose=True
        )
```

### Planned Integrations
- **AutoGPT:** Autonomous goal-driven agents (Phase 2)
- **MetaGPT:** Software company simulation (Phase 2) 
- **AgentLite:** Lightweight agents для specific tasks
- **Custom Framework:** Proprietary orchestration layer

---

## 🏗️ Infrastructure Requirements

### Development Environment
```yaml
# docker-compose.dev.yml structure
version: '3.8'
services:
  llmgenie-core:
    build: ./core
    ports: ["8000:8000"]
    depends_on: [postgres, redis]
    
  postgres:
    image: postgres:15
    environment:
      POSTGRES_DB: llmgenie
      
  redis:
    image: redis:7-alpine
    
  monitoring:
    image: prom/prometheus
    ports: ["9090:9090"]
```

### Production K8s Requirements
```yaml
# Minimal resource requirements
resources:
  limits:
    cpu: "2"
    memory: "4Gi" 
  requests:
    cpu: "500m"
    memory: "1Gi"

# Scaling parameters
replicas:
  min: 2
  max: 10
  target_cpu: 70%
```

---

## 🔒 Security Architecture

### Access Control
- **RBAC:** Kubernetes-native role-based access
- **API Authentication:** JWT tokens + OAuth2
- **Agent Permissions:** Hierarchical permission system
- **Network Security:** Network policies, service mesh (Istio planned)

### Compliance Features
- **Audit Logging:** All agent actions logged
- **Data Encryption:** At rest и in transit
- **Secret Management:** Kubernetes secrets + HashiCorp Vault
- **Privacy Controls:** GDPR/SOC2 compliance features

---

## 📊 Monitoring & Metrics

### Key Metrics to Track
```yaml
Agent Performance:
  - response_time_seconds
  - task_completion_rate
  - error_rate_percent
  - resource_utilization

System Health:
  - kubernetes_pod_status
  - api_response_time
  - database_connection_pool
  - message_queue_depth

Business Metrics:
  - active_agent_sessions
  - customer_task_completions
  - revenue_generating_actions
  - user_satisfaction_score
```

### Dashboard Requirements
- **Real-time agent activity** visualization
- **Performance metrics** trending
- **Error tracking** и alerting
- **Resource utilization** monitoring
- **Customer usage** patterns

---

## 🚀 Deployment Architecture

### Environment Strategy
```
Development → Staging → Production
     ↓           ↓          ↓
  Local K8s → Cloud K8s → Multi-AZ K8s
```

### CI/CD Pipeline
```yaml
Stages:
  - Code Quality: linting, testing, security scan
  - Build: Docker image creation
  - Test: Integration tests, E2E tests  
  - Deploy: Automated deployment to staging
  - Approve: Manual approval для production
  - Production: Blue-green deployment
  - Monitor: Post-deployment verification
```

---

## 🔧 DevOps Automation Opportunities

### Infrastructure as Code
- **Terraform:** Cloud resource provisioning
- **Helm Charts:** Kubernetes application deployment
- **Ansible:** Configuration management
- **GitOps:** ArgoCD для declarative deployments

### AI-Driven DevOps (Meta-level)
- **Predictive Scaling:** ML-based resource prediction
- **Automated Incident Response:** AI agents для troubleshooting
- **Cost Optimization:** Intelligent resource scheduling
- **Performance Tuning:** AI-driven optimization recommendations

---

## 📋 Development Workflow

### Git Strategy
```
main (production)
├── develop (integration)
├── feature/* (development)
├── release/* (staging)
└── hotfix/* (emergency fixes)
```

### Code Quality Standards
- **Type Hints:** Full Python typing
- **Testing:** 80%+ coverage requirement
- **Documentation:** Comprehensive docstrings
- **Code Review:** Required PR reviews
- **Security Scanning:** Automated SAST/DAST

---

## 🎯 Performance Targets

### Response Time SLAs
- **Agent Response:** <2 seconds (95th percentile)
- **API Endpoints:** <500ms (99th percentile)  
- **UI Interactions:** <200ms (95th percentile)
- **Complex Tasks:** <30 seconds (agent orchestration)

### Availability Targets
- **System Uptime:** 99.9% (8.76 hours downtime/year)
- **API Availability:** 99.95%
- **Agent Availability:** 99.5% per agent type
- **Data Durability:** 99.999% (5 nines)

---

## 🔍 Debugging & Troubleshooting

### Logging Strategy
```python
# Structured logging example
import structlog

logger = structlog.get_logger()

logger.info(
    "agent_task_started",
    agent_id="devops-001",
    task_type="infrastructure_scan",
    user_id="user-123",
    session_id="sess-456"
)
```

### Debugging Tools
- **Distributed Tracing:** Request flow across agents
- **Metrics Dashboards:** Real-time system health
- **Log Aggregation:** Centralized log search
- **Profiling:** Performance bottleneck identification

---

## 📚 Ресурсы для Изучения

### Documentation Links
- **CrewAI Docs:** https://docs.crewai.com/
- **Kubernetes Best Practices:** Internal knowledge base
- **FastAPI Guide:** https://fastapi.tiangolo.com/
- **Prometheus Monitoring:** https://prometheus.io/docs/

### Internal Resources
- **Project Knowledge Base:** `data/knowledge_base/`
- **Architecture Decisions:** `docs/decisions/`
- **API Documentation:** Auto-generated from code
- **Deployment Guides:** `docs/deployment/`

---

**Next Steps:** После изучения этого документа, следующий step - hands-on setup local environment и первые infrastructure experiments.

---
*Обновлено: 2025-06-05*  
*Поддерживает: DevOps onboarding process* 