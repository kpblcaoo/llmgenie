# Эпик 2: Пилот background-агентов Cursor (фаза 1 masterplan v2)

Дата: 2024-06-13
Автор: ai_assistant

---

## Чеклист (финальный статус)
- [x] Ознакомиться с документацией Cursor по background-агентам.
- [x] Отключить privacy mode (решено не использовать background-агенты Cursor до появления поддержки приватного режима).
- [x] Настроить GitHub-доступ (уже выполнено ранее).
- [x] Создать/настроить `.cursor/environment.json` (готово, но не используется для background-агентов).
- [x] Проверить запуск background-агента — ОТМЕНЕНО (privacy mode, отказ от передачи данных в облако).
- [x] Зафиксировать причину отмены: отсутствие поддержки приватного режима, решение — не использовать до появления поддержки.
- [x] Проверить альтернативы: Ollama — успешно, работает локально, GPU используется.
- [x] Реализовать очередь команд для Ollama (Python-скрипт, интеграция с пайплайном тестирования/генерации кода/анализа).
- [x] Документировать best practices и сценарии использования Ollama в knowledge base (минимально зафиксировано, расширение — в отдельном эпике).
- [x] Включить выводы о невозможности использования background-агентов в privacy mode и успешной интеграции Ollama в lessons learned по фазе.
- [x] Подготовить рекомендации для пилота MCP (Model Context Protocol) в knowledge base и memos (вынести в отдельный эпик).

## Lessons learned (фаза 1, дополнено)

- **Background-агенты Cursor** не подходят для приватных проектов до появления поддержки privacy mode.
- **Ollama** — эффективная альтернатива для приватной автоматизации LLM-задач, работает локально, использует GPU.
- **Плюсы Ollama:** приватность, гибкость, автоматизация рутинных задач через очередь, контроль результатов, снижение нагрузки на основной LLM-контекст.
- **Минусы Ollama:** качество reasoning уступает GPT-4/Claude-3, нет "родного" MCP-сервера (но можно реализовать свой), требуется автоматическая валидация результата.
- **Архитектурные принципы эффективного использования Ollama:** атомизация задач, очередь команд, автоматическая валидация результата, интеграция с MCP, фокус основного LLM на сложных задачах.
- **Примеры сценариев:** генерация unit-тестов, объяснение кода, рефакторинг, генерация changelog, аудит кода.
- **MCP и Ollama:** MCP-сервер-прокси может выступать glue layer между Cursor и Ollama, обеспечивая автоматизацию, прозрачность и масштабируемость.
- **Честная рекомендация:** Ollama — для рутинных, атомарных задач; сложный reasoning — за более мощными LLM через Cursor; MCP — идеальный glue layer для интеграции и автоматизации.
- **Следующие шаги:** вынести MCP, knowledge base и автоматизацию пайплайна в отдельные эпики; описать сценарии атомизации задач, спроектировать MCP-сервер-прокси, документировать best practices, интегрировать MCP-сервер в Cursor через deeplink, построить пайплайн: задача → очередь → Ollama → валидация → результат в IDE/логах.
- **Вся работа и фиксация результатов ведётся в проектных файлах (session log, knowledge base, scripts), а не только в чате.**
- **Ветка эпика базировалась не из develop, а из текущей рабочей ветки (зафиксировано для истории и анализа merge).**

---

## Эпик завершён
- Все ключевые задачи выполнены или вынесены в отдельные направления для масштабирования.
- Lessons learned и новые направления зафиксированы для будущих эпиков.
- Рекомендация: скорректировать мастер-план и запустить новые эпики по MCP, knowledge base и автоматизации пайплайна.
- Сессия завершена согласно workflow: все действия, reasoning и результаты зафиксированы в проектных файлах и session log.

---

## Цели эпика
- Исследовать и опробовать background-агентов Cursor для автоматизации рутинных задач, CI/CD, тестов, обновлений.
- Зафиксировать сценарии, ограничения, lessons learned для дальнейшей интеграции в multi-agent workflows.
- Подготовить шаблоны, инструкции и best practices для команды.

---

## Подробный чеклист и задачи
### 1. Подготовка окружения
- [ ] Ознакомиться с документацией Cursor по background-агентам.
- [ ] Отключить privacy mode (если требуется).
- [ ] Настроить GitHub-доступ (read-write) для репозитория.(это уже выполнено, насколько я знаю)
- [ ] Создать/настроить `.cursor/environment.json` (или Dockerfile) для пилотных задач.

### 2. Пилотирование background-агентов
- [ ] Запустить background-агента для простой задачи (например, тесты, линтинг, обновление зависимостей).
- [ ] Проверить создание ветки, PR, работу с облачным окружением.
- [ ] Протестировать параллельный запуск нескольких агентов (разные задачи).
- [ ] Зафиксировать сценарии, ограничения, баги, производительность.

### 3. Документирование и lessons learned
- [ ] Описать сценарии использования, шаблоны environment.json, best practices.
- [ ] Зафиксировать ограничения, проблемы, предложения по улучшению.
- [ ] Подготовить рекомендации для интеграции в multi-agent workflows.

---

## Критерии успеха эпика
- Успешно проведён пилот background-агентов на простых задачах.
- Зафиксированы сценарии, ограничения, lessons learned.
- Подготовлены шаблоны и рекомендации для команды.
- Готовность к масштабированию и интеграции в последующих фазах.

---

## Рекомендации для запуска эпика в отдельном чате
- Использовать этот чеклист как трекер задач.
- Фиксировать все промежуточные результаты и выводы.
- По завершении — подготовить summary и lessons learned для следующей фазы.

---

## Фиксация файлового контекста для восстановления
- Мастер-план: `docs/memos/2024-06-epic-mcp-integration-masterplan-v2.md`
- Эпик 1 (фаза 0): `docs/memos/2024-06-epic-mcp-integration-epic1-phase0.md`
- Эпик 2 (пилот background-агентов): `docs/memos/2024-06-epic-mcp-integration-epic2-bg-agents-pilot.md`
- Ключевые источники: `@230_project_auditor.mdc`, `@PROJECT_VISION.md`, `@ARCHIVE_ANALYSIS_REPORT.md`, `@project_state.json`
- Все lessons learned, сценарии, шаблоны — фиксировать в соответствующих memos и decision log.

---

_Эпик готов к запуску в отдельном чате. Для восстановления контекста — использовать указанные файлы и memos._ 