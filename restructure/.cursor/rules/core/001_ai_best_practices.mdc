---
description: AI best practices, enforcement & behavior
alwaysApply: true
---

## Meta

# AI Best Practices (enforcement & behavior)

## Meta
- role: core
- applies to: [meta, discuss, code]
- links: @data/ai_workflow.json, @data/logs/sessions/session_<current>.jsonl, @project_state.json, @docs/decision_memos/

## Required JSON Files (Rules-First)
- Workflow stages: @data/ai_workflow.json
- Session log: @data/logs/sessions/session_<current>.jsonl
- Project state: @project_state.json
- Decision memos: @docs/decision_memos/ (by reference)

## Rules-First & .mdc_ Work Protocol
- AI всегда стартует с правил (.cursor/rules/*.mdc), не с JSON
- Все изменения правил — только на .mdc_ копиях, НЕ на оригиналах
- После тестов и ревью — вручную заменить оригинальные .mdc
- Все изменения логировать в session log с checkpoints
- JSON-файлы подключаются только по требованию правил

## Core Principles
- Always check data/ai_workflow.json for workflow stages, checklists, and templates.
- Log all key actions, errors, and mode switches in event_log/meta-log (unless outside of session, then warn user).
- When asked for advice, provide an objective answer; do not let the desire to please affect quality.
- May suggest hypotheses/ideas if the user expects it, but must always mark them as NOT implemented/NOT fixed.
- If an action is only possible within the current session or discussion, explicitly warn the user.
- All new best practices and workflows must be recorded in .cursor/rules/ or documentation for reproducibility.
- If focus is lost, restore it using meta-log and ai_workflow.json.
- Do not duplicate details — only basic rules here, details by reference.
- Main links:
    - workflow: data/ai_workflow.json
    - rules: .cursor/rules/
    - docs: docs/ONBOARDING_LLMSTRUCT.md, docs/BEST_PRACTICES_LLMSTRUCT.md

# Language Policy for Prompts and Communication

- All prompts intended for AI/LLM (prompts_collection.json, workflow, automation) must be written in English for maximum compatibility and reproducibility.
- All communication, advice, and discussion for the user can be in Russian (or any language the user prefers).
- This ensures LLM compatibility and user comfort.

## Example: Start Prompt for New Session

```
Восстанови рабочий контекст по проекту llmstruct. Ориентируйся на user rules, .cursor/rules/, data/ai_workflow.json, project_manifest.json, prompts_collection.json. Соблюдай branch policy: не изменяй ничего вне сессии/ветки, логируй все действия, предупреждай о рисках вне сессии. Давай советы объективно, не подстраиваясь под мои ожидания. Общайся со мной на русском, но промты для AI используй на английском.
```

- Prompts for AI/LLM: English only
- User-facing text: Russian (or user-selected language)

# Best Practice: Анализ решений и trade-off'ов

- При планировании и внедрении новых решений AI обязан:
  - Анализировать возможные недостатки и ограничения
  - Предлагать альтернативы и улучшения
  - Аргументировать выбор
  - Фиксировать trade-off'ы и lessons learned
  - Документировать обсуждения в decision memos и логах

## Пример
- Для мульти-ролевой архитектуры:
  - Плюсы: гибкость, масштабируемость
  - Минусы: сложность, риски путаницы, приватность
  - Улучшения: role manifest, role switch log, ограничения на передачу контекста, UX-подсказки
