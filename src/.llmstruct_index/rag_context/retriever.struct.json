{
  "module_id": "rag_context.retriever",
  "path": "rag_context/retriever.py",
  "category": "core",
  "module_doc": "Context Retriever с FAISS для поиска релевантных правил",
  "functions": [
    {
      "name": "__init__",
      "docstring": "",
      "line_range": [
        26,
        35
      ],
      "parameters": [
        "self",
        "embedder",
        "max_chunks",
        "similarity_threshold"
      ],
      "decorators": []
    },
    {
      "name": "index_documents",
      "docstring": "Индексирует документы для поиска",
      "line_range": [
        37,
        76
      ],
      "parameters": [
        "self",
        "documents"
      ],
      "decorators": []
    },
    {
      "name": "retrieve",
      "docstring": "Ищет релевантные документы для запроса",
      "line_range": [
        78,
        112
      ],
      "parameters": [
        "self",
        "query",
        "max_results"
      ],
      "decorators": []
    },
    {
      "name": "_chunk_document",
      "docstring": "Разбивает документ на чанки (пока простая реализация)",
      "line_range": [
        114,
        138
      ],
      "parameters": [
        "self",
        "document",
        "chunk_size"
      ],
      "decorators": []
    },
    {
      "name": "_deduplicate_results",
      "docstring": "Убирает дубли и сортирует по релевантности",
      "line_range": [
        140,
        154
      ],
      "parameters": [
        "self",
        "results"
      ],
      "decorators": []
    },
    {
      "name": "get_stats",
      "docstring": "Статистика retriever",
      "line_range": [
        156,
        164
      ],
      "parameters": [
        "self"
      ],
      "decorators": []
    }
  ],
  "classes": [
    {
      "name": "RetrievalResult",
      "docstring": "Результат поиска контекста",
      "line_range": [
        16,
        20
      ],
      "methods": [],
      "bases": []
    },
    {
      "name": "ContextRetriever",
      "docstring": "FAISS-based retriever для поиска релевантного контекста",
      "line_range": [
        23,
        164
      ],
      "methods": [
        {
          "name": "__init__",
          "docstring": "",
          "line_range": [
            26,
            35
          ],
          "parameters": [
            "self",
            "embedder",
            "max_chunks",
            "similarity_threshold"
          ]
        },
        {
          "name": "index_documents",
          "docstring": "Индексирует документы для поиска",
          "line_range": [
            37,
            76
          ],
          "parameters": [
            "self",
            "documents"
          ]
        },
        {
          "name": "retrieve",
          "docstring": "Ищет релевантные документы для запроса",
          "line_range": [
            78,
            112
          ],
          "parameters": [
            "self",
            "query",
            "max_results"
          ]
        },
        {
          "name": "_chunk_document",
          "docstring": "Разбивает документ на чанки (пока простая реализация)",
          "line_range": [
            114,
            138
          ],
          "parameters": [
            "self",
            "document",
            "chunk_size"
          ]
        },
        {
          "name": "_deduplicate_results",
          "docstring": "Убирает дубли и сортирует по релевантности",
          "line_range": [
            140,
            154
          ],
          "parameters": [
            "self",
            "results"
          ]
        },
        {
          "name": "get_stats",
          "docstring": "Статистика retriever",
          "line_range": [
            156,
            164
          ],
          "parameters": [
            "self"
          ]
        }
      ],
      "bases": []
    }
  ],
  "callgraph": {
    "__init__": [],
    "index_documents": [
      "normalized_embeddings.append",
      "np.vstack",
      "texts.extend",
      "print",
      "self._chunk_document",
      "len",
      "faiss.IndexFlatIP"
    ],
    "retrieve": [
      "zip",
      "query_embedding.reshape",
      "min",
      "RetrievalResult",
      "float",
      "self._deduplicate_results",
      "results.append",
      "print",
      "len"
    ],
    "_chunk_document": [
      "chunks.append",
      "len",
      "current_chunk.strip",
      "content.split"
    ],
    "_deduplicate_results": [
      "list",
      "unique_results.sort",
      "source_to_best.values"
    ],
    "get_stats": [
      "len"
    ]
  },
  "dependencies": [
    "Any",
    "Dict",
    "Document",
    "List",
    "Optional",
    "Path",
    "SimpleEmbedder",
    "Tuple",
    "dataclass",
    "dataclasses",
    "embedder",
    "faiss",
    "json",
    "loader",
    "numpy",
    "pathlib",
    "typing"
  ],
  "hash": "551fd92175d5e562bef96e127736f97d365d06be58df4b7b543ec72280fe84de",
  "artifact_id": "8b7bb2fe-88dd-4989-aee8-a2d2c0c84ff5"
}